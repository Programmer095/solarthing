@version: 3.26
@include "scl.conf"

options { use_dns(no); };

# https://www.systutorials.com/docs/linux/man/5-syslog-ng.conf/
# UDP magically makes multi line stuff work

source s_local { # messages generated internally in syslog-ng
	internal();
};

source s_network {
	#default-network-drivers();
	#tcp(port(601) keep-alive(yes));
	syslog(
		transport("udp")
		port(514)
	);
};

destination d_local {
	file("/var/log/messages");
};

filter f_matepi { host("192.168.10.200"); };
filter f_roverpi { host("192.168.10.201"); };
filter f_mate_program { facility(local0); };
filter f_rover_program { facility(local1); };
filter f_request_program { facility(local2); };

destination d_matepi_mate {
	file("/opt/solarthing/logs/matepi/mate/log.log");
};
destination d_matepi_request {
	file("/opt/solarthing/logs/matepi/request/log.log");
};
destination d_roverpi_rover {
	file("/opt/solarthing/logs/roverpi/rover/log.log");
};

#log {
#	source(s_local);
#	source(s_network);
#	destination(d_local);
#};


log {
	source(s_network);
	filter(f_matepi);
	filter(f_mate_program);
	destination(d_matepi_mate);
};
log {
	source(s_network);
	filter(f_matepi);
	filter(f_request_program);
	destination(d_matepi_request);
};

log {
	source(s_network);
	filter(f_roverpi);
	filter(f_rover_program);
	destination(d_roverpi_rover);
};
